using System.Collections;
using System.Collections.Generic;
using System.Drawing;
using Unity.VisualScripting;
using UnityEngine;
using UnityEngine.UI;

public class BallManager : MonoBehaviour
{
    public GameObject ball;
    public Text countUI;

    //WallMoving 에서 사용할 수 있도록 public으로 변수 선언
    public float checkTime = 0; // ???????????? ???????? ???? ???? ??????

    // Start is called before the first frame update
    void Start()
    {
        ball = Resources.Load<GameObject>("Prefabs/Ball");
        ball = Instantiate(ball);
        ball.transform.position = new Vector2(0, 10);
        StartCoroutine(StartBall());
    }

    // Update is called once per frame
    void Update()
    {
        
    }

    public void Spawn()
    {
        // ?? ???????? ?????????? ??????????.
        ball = Resources.Load<GameObject>("Prefabs/Ball");
        // ?????? ???????? ???????? ???? ???? ?????????? ??????????.
        ball = Instantiate(ball);
        // ?????? ???? ???? ?????? ??????????.
        ball.transform.position = new Vector2(0, 10);
        // ?????????? ???????? ??????????.
        StartCoroutine(StartBall());
    }

    private IEnumerator StartBall()
    {
        // ?????????? UI?? ????????????.
        countUI.enabled = true;
        // ???? ?????? ?? ????
        int count = 3;
        countUI.text = count.ToString();
        checkTime = 0;

        while (checkTime <= 3) // 3?? ???? ????
        {
            // ???? ?????? ???? ?????? ?? ????
            if (checkTime >= 2)
            {
                count = 1;
                countUI.text = count.ToString();
            }
            else if (checkTime >= 1)
            {
                count = 2;
                countUI.text = count.ToString();
            }

            // ?????? ??????????????.
            checkTime += Time.deltaTime;
            yield return null; // ?? ???????? ??????????.
        }
        // ???????????? ???????? UI?? ???????????? ???? ?????? ??????????.
        countUI.enabled = false;
        ball.GetComponent<BallMoving>().StartMove = true; // BallMoving ?????????? StartMove?? ????????????.
        yield break; // ???????? ??????????.
    }

}
